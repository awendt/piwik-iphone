<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="<%= I18n.locale %>" lang="<%= I18n.locale %>">
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <title>Piwik with jQuery visualize plugin</title>
    <link type="text/css" rel="stylesheet" href="visualize.jQuery.css"/>
    <link type="text/css" rel="stylesheet" href="demopage.css"/>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js" />
    <!--[if IE]><script type="text/javascript" src="excanvas.compiled.js"></script><![endif]-->
    <script type="text/javascript" src="visualize.jQuery.js"></script>
    <script type="text/javascript">

      var query_string_2hash = function(query_string) {
        var hash = {};
        $.each(query_string.split("&"), function(i, query_param) {
          key_value = query_param.split("=");
          hash[key_value[0]] = key_value[1]; 
        });
        return hash;
      };

      $(function(){
        query_hash = query_string_2hash(document.location.search.slice(1));
        var install = query_hash.install || "piwik.org/demo";
        var url = ((document.location.protocol === "https:") ? "https://" : "http://") +install;
        var token_query = query_hash.token ? "&token_auth="+query_hash.token : "";
        $.getJSON(url+"/?module=API&method=VisitsSummary.getVisits&idSite="+(query_hash.site || 1)+"&period=day&date=last10&format=json"+token_query+"&jsoncallback=?", function(json) {
          $.each(json, function(key, value) {
            $('#visits tbody').append("<tr><th>"+key+"</th><td>"+value+"</td></tr>")
          });
          $("#visits").visualize({type: 'area', parseDirection: 'y', appendKey: false});
        });
      });
    </script>
  </head>
  <body>
    <table id="visits">
      <caption>Besucher der letzten 10 Tage</captions>
      <thead>
        <tr>
          <td></td>
          <th>Besucher</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </body>
</html>